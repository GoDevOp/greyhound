===============================================================================
Greyhound
===============================================================================

:author: Connor Manning
:email: connor@hobu.com
:date: 09/30/2014

Overview
===============================================================================

Greyhound is a distributed server architecture that abstracts and maintains persistent sessions for PDAL pipelines used for real-time querying of point cloud data.

Using Greyhound
===============================================================================

Connecting
-------------------------------------------------------------------------------

TODO

Issuing Commands
-------------------------------------------------------------------------------

TODO

Disconnecting
-------------------------------------------------------------------------------

TODO

API
===============================================================================

Command Set
-------------------------------------------------------------------------------

+---------------+-------------------------------------------------------------+
| Command       | Function                                                    |
+===============+=============================================================+
| put           | Store a pipeline.                                           |
+---------------+-------------------------------------------------------------+
| create        | Create a PDAL session using a previously stored pipeline.   |
+---------------+-------------------------------------------------------------+
| pointsCount   | Get the number of points present in a session.              |
+---------------+-------------------------------------------------------------+
| schema        | Get the Greyhound schema of a session.                      |
+---------------+-------------------------------------------------------------+
| srs           | Get the spatial reference system of a session.              |
+---------------+-------------------------------------------------------------+
| read          | Read points from a session.                                 |
+---------------+-------------------------------------------------------------+
| cancel        | Cancel an ongoing 'read' command.                           |
+---------------+-------------------------------------------------------------+
| destroy       | Destroy an active session.                                  |
+---------------+-------------------------------------------------------------+

|

Command and Response format
-------------------------------------------------------------------------------

Greyhound commands are issued as JSON objects over a WebSocket connection, and every command sent to Greyhound will initiate a response.  Strings are UTF-8 encoded, and all commands are case sensitive.

Parentheses ``()`` around a key indicate optional or conditional keys that will not necessarily be present.  Quotation marks ``""`` around a field indicate a string literal, as opposed to a description.

Each command shares a common basic format:

+---------------------+-------------+------------------------------------------------+
| Key                 | Type        | Value                                          |
+=====================+=============+================================================+
| ``"command"``       | String      | Command name                                   |
+---------------------+-------------+------------------------------------------------+
| (command parameters)| Various     | Command-dependent values                       |
+---------------------+-------------+------------------------------------------------+

|

Greyhound only transmits data in response to a command, and does not send any transmissions unprompted.  Responses also share a common format:

+-----------------------+--------------+--------------------------------------------------+
| Key                   | Type         | Value                                            |
+=======================+==============+==================================================+
| ``"command"``         | String       | Command name received in initial command         |
+-----------------------+--------------+--------------------------------------------------+
| ``"status"``          | Integer      | ``1`` for success, else ``0``                    |
+-----------------------+--------------+--------------------------------------------------+
| (``"message"``)       | String       | Information message regarding this command       |
+-----------------------+--------------+--------------------------------------------------+
| (``"reason"``)        | String       | Notification of a problem with this command      |
+-----------------------+--------------+--------------------------------------------------+
| (response parameters) | Various      | Command-dependent values                         |
+-----------------------+--------------+--------------------------------------------------+

|

Command Details
-------------------------------------------------------------------------------

Put
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

+-------------------------------------------------------------------------------------+
| Command                                                                             |
+-------------------+------------+----------------------------------------------------+
| Key               | Type       | Value                                              |
+===================+============+====================================================+
| ``"command"``     | String     | ``"put"``                                          |
+-------------------+------------+----------------------------------------------------+
| ``"pipeline"``    | String     | PDAL pipeline XML                                  |
+-------------------+------------+----------------------------------------------------+

+-------------------------------------------------------------------------------------+
| Response                                                                            |
+-------------------+------------+----------------------------------------------------+
| Key               | Type       | Value                                              |
+===================+============+====================================================+
| ``"command"``     | String     | ``"put"``                                          |
+-------------------+------------+----------------------------------------------------+
| ``"status"``      | Integer    | ``1`` for success, else ``0``                      |
+-------------------+------------+----------------------------------------------------+
| ``"pipelineId"``  | String     | Greyhound pipeline ID                              |
+-------------------+------------+----------------------------------------------------+

TODO
    Error behavior - invalid PDAL XML or missing pipeline param.

    Response format - returns pipelineId of inserted pipeline.

Create
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

+-------------------------------------------------------------------------------+
| Command                                                                       |
+-----------------+------------+------------------------------------------------+
| Key             | Type       | Value                                          |
+=================+============+================================================+
| ``"command"``   | String     | ``"create"``                                   |
+-----------------+------------+------------------------------------------------+
| ``"pipelineId"``| String     | Greyhound pipeline ID                          |
+-----------------+------------+------------------------------------------------+

+-------------------------------------------------------------------------------------+
| Response                                                                            |
+-------------------+------------+----------------------------------------------------+
| Key               | Type       | Value                                              |
+===================+============+====================================================+
| ``"command"``     | String     | ``"create"``                                       |
+-------------------+------------+----------------------------------------------------+
| ``"status"``      | Integer    | ``1`` for success, else ``0``                      |
+-------------------+------------+----------------------------------------------------+
| ``"session"``     | String     | Greyhound session ID                               |
+-------------------+------------+----------------------------------------------------+

TODO
    Error behavior - invalid pipelineId

    Response format - returns session ID.

Points Count
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

+-----------------------------------------------------------------------------+
| Command                                                                     |
+---------------+------------+------------------------------------------------+
| Key           | Type       | Value                                          |
+===============+============+================================================+
| ``"command"`` | String     | ``"pointsCount"``                              |
+---------------+------------+------------------------------------------------+
| ``"session"`` | String     | Greyhound session ID                           |
+---------------+------------+------------------------------------------------+

+-------------------------------------------------------------------------------------+
| Response                                                                            |
+-------------------+------------+----------------------------------------------------+
| Key               | Type       | Value                                              |
+===================+============+====================================================+
| ``"command"``     | String     | ``"pointsCount"``                                  |
+-------------------+------------+----------------------------------------------------+
| ``"status"``      | Integer    | ``1`` for success, else ``0``                      |
+-------------------+------------+----------------------------------------------------+
| ``"count"``       | Integer    | Number of points in this session                   |
+-------------------+------------+----------------------------------------------------+

TODO
    Error behavior

    Response format

Schema
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

+-----------------------------------------------------------------------------+
| Command                                                                     |
+---------------+------------+------------------------------------------------+
| Key           | Type       | Value                                          |
+===============+============+================================================+
| ``"command"`` | String     | ``"schema"``                                   |
+---------------+------------+------------------------------------------------+
| ``"session"`` | String     | Greyhound session ID                           |
+---------------+------------+------------------------------------------------+

+-----------------------------------------------------------------------------------------+
| Response                                                                                |
+-------------------+------------+--------------------------------------------------------+
| Key               | Type       | Value                                                  |
+===================+============+========================================================+
| ``"command"``     | String     | ``"pointsCount"``                                      |
+-------------------+------------+--------------------------------------------------------+
| ``"status"``      | Integer    | ``1`` for success, else ``0``                          |
+-------------------+------------+--------------------------------------------------------+
| ``"schema"``      | String     | JSON stringified Greyhound schema for this session     |
+-------------------+------------+--------------------------------------------------------+

TODO
    Describe JSON schema

    Error behavior

    Response format
    
Spatial Reference System
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

+-----------------------------------------------------------------------------+
| Command                                                                     |
+---------------+------------+------------------------------------------------+
| Key           | Type       | Value                                          |
+===============+============+================================================+
| ``"command"`` | String     | ``"srs"``                                      |
+---------------+------------+------------------------------------------------+
| ``"session"`` | String     | Greyhound session ID                           |
+---------------+------------+------------------------------------------------+

+-----------------------------------------------------------------------------------------+
| Response                                                                                |
+-------------------+------------+--------------------------------------------------------+
| Key               | Type       | Value                                                  |
+===================+============+========================================================+
| ``"command"``     | String     | ``"srs"``                                              |
+-------------------+------------+--------------------------------------------------------+
| ``"status"``      | Integer    | ``1`` for success, else ``0``                          |
+-------------------+------------+--------------------------------------------------------+
| ``"srs"``         | String     | Spatial reference system for this session              |
+-------------------+------------+--------------------------------------------------------+

TODO
    Describe SRS string?
    
    Error behavior

    Response format

Read
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

TODO

+---------------+------------+------------------------------------------------+
| Key           | Type       | Value                                          |
+===============+============+================================================+
| command       | String     | 'read'                                         |
+---------------+------------+------------------------------------------------+
| session       | String     | <Greyhound session ID>                         |
+---------------+------------+------------------------------------------------+

TODO
    Various types of 'read' commands.

TODO
    Error behavior

    Response format

Cancel
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

TODO

Destroy
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

+-----------------------------------------------------------------------------+
| Command                                                                     |
+---------------+------------+------------------------------------------------+
| Key           | Type       | Value                                          |
+===============+============+================================================+
| ``"command"`` | String     | ``"destroy"``                                  |
+---------------+------------+------------------------------------------------+
| ``"session"`` | String     | Greyhound session ID                           |
+---------------+------------+------------------------------------------------+

+-----------------------------------------------------------------------------------------+
| Response                                                                                |
+-------------------+------------+--------------------------------------------------------+
| Key               | Type       | Value                                                  |
+===================+============+========================================================+
| ``"command"``     | String     | ``"destroy"``                                          |
+-------------------+------------+--------------------------------------------------------+
| ``"status"``      | Integer    | ``1`` for success, else ``0``                          |
+-------------------+------------+--------------------------------------------------------+

TODO
    Descriptions

Deploying Greyhound
===============================================================================

Setting up the Server
-------------------------------------------------------------------------------

TODO

Configuring Greyhound Settings
-------------------------------------------------------------------------------

TODO
